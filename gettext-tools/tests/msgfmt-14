#! /bin/sh

# Test that an out-of-range Unicode character doesn't lead to a crash.

tmpfiles=""
trap 'rm -fr $tmpfiles' 1 2 3 15

tmpfiles="$tmpfiles mf-test14.po"
cat <<\EOF >mf-test14.po
# SOME DESCRIPTIVE TITLE.
# Copyright (C) YEAR Free Software Foundation, Inc.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: minicom 2.1\n"
"POT-Creation-Date: 2003-05-16 22:33+0200\n"
"PO-Revision-Date: 2003-09-11 14:10+0200\n"
"Last-Translator: Jochen Hein <jochen@jochen.org>\n"
"Language-Team: german <de@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: src/file.c:60
msgid " [Goto]  [Prev]  [Show]  [Tag]  [Untag]  [Okay] "
msgstr " [Gehe zu]  [Zurück]  [Anzeigen]  [Markieren]  [Markierung len]  [Okay] "

EOF

tmpfiles="$tmpfiles mf-test14.mo"
: ${MSGFMT=msgfmt}
${MSGFMT} mf-test14.po -o mf-test14.mo
test $? = 0 || { rm -fr $tmpfiles; exit 1; }

rm -fr $tmpfiles

exit $result
